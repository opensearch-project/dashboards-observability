{
  "template": {
    "_meta": {
      "version": "1.0.0",
      "catalog": "security",
      "type": "logs",
      "component": "ecs",
      "labels": ["ecs"]
    },
    "settings": {
      "refresh_interval" : "2s",
      "index.mapping.ignore_malformed": true,
      "index.max_docvalue_fields_search": 200,
      "number_of_shards": 3
    },
    "mappings": {
      "dynamic_templates": [{
        "strings": {
          "match_mapping_type": "string",
          "mapping": {"type": "keyword"}
        }
      }],
      "properties": {
        "@timestamp": {"type": "date"},
        "@message": {"type": "text"},
        "cwl_timestamp": {"type": "date", "format": "epoch_millis"},
        "cwe_timestamp": {"type": "date"},
        "base": {"type": "object"},
        "base.tags": {"type": "keyword"},
        "base.labels": {"type": "object"},
        "agent": {"type": "object"},
        "as": {"type": "object"},
        "client": {"type": "object"},
        "cloud": {"type": "object"},
        "code_signature": {"type": "object"},
        "container": {"type": "object"},
        "container.image.tag": {"type": "keyword"},
        "container.labels": {"type": "object"},
        "data_stream": {"type": "object"},
        "destination": {"type": "object"},
        "destination.as.number": {"type": "integer"},
        "destination.as.organization.name": {"type": "keyword"},
        "destination.bytes": {"type": "long"},
        "destination.geo.city_name": {"type": "keyword"},
        "destination.geo.country_iso_code": {"type": "keyword"},
        "destination.geo.country_name": {"type": "keyword"},
        "destination.geo.location": {"type": "geo_point"},
        "destination.ip": {"type": "ip"},
        "destination.nat.ip": {"type": "ip"},
        "destination.nat.port": {"type": "integer"},
        "destination.packets": {"type": "long"},
        "destination.port": {"type": "integer"},
        "dll": {"type": "object"},
        "dns": {"type": "object"},
        "dns.answers": {"type": "object"},
        "dns.answers.ttl": {"type": "long"},
        "dns.id": {"type": "keyword"},
        "dns.header_flags": {"type": "keyword"},
        "dns.resolved_ip": {"type": "ip"},
        "ecs": {"type": "object"},
        "elf": {"type": "object"},
        "error": {"type": "object"},
        "error.message": {"type": "text"},
        "event": {"type": "object"},
        "event.category": {"type": "keyword"},
        "event.code": {"type": "keyword"},
        "event.created": {"type": "date"},
        "event.duration": {"type": "long"},
        "event.end": {"type": "date"},
        "event.id": {"type": "keyword"},
        "event.ingested": {"type": "date"},
        "event.kind": {"type": "keyword"},
        "event.outcome": {"type": "keyword"},
        "event.risk_score": {"type": "float"},
        "event.risk_score_norm": {"type": "float"},
        "event.sequence": {"type": "long"},
        "event.severity": {"type": "long"},
        "event.start": {"type": "date"},
        "event.timezone": {"type": "keyword"},
        "event.type": {"type": "keyword"},
        "file": {"type": "object"},
        "file.accessed": {"type": "date"},
        "file.attributes": {"type": "keyword"},
        "file.created": {"type": "date"},
        "file.ctime": {"type": "date"},
        "file.gid": {"type": "keyword"},
        "file.inode": {"type": "keyword"},
        "file.mode": {"type": "keyword"},
        "file.mtime": {"type": "date"},
        "file.size": {"type": "long"},
        "file.uid": {"type": "keyword"},
        "geo": {"type": "object"},
        "group": {"type": "object"},
        "group.id": {"type": "keyword"},
        "hash": {"type": "object"},
        "host": {"type": "object"},
        "host.disk.read.bytes": {"type": "long"},
        "host.disk.write.bytes": {"type": "long"},
        "host.hostname": {"type": "keyword"},
        "host.id": {"type": "keyword"},
        "host.ip": {"type": "ip"},
        "host.mac": {"type": "keyword"},
        "host.network.egress.bytes": {"type": "long"},
        "host.network.egress.packets": {"type": "long"},
        "host.network.ingress.bytes": {"type": "long"},
        "host.network.ingress.packets": {"type": "long"},
        "host.uptime": {"type": "long"},
        "http": {"type": "object"},
        "http.request.body.bytes": {"type": "long"},
        "http.request.body.content": {"type": "keyword", "fields": {"text": {"type": "text"}}},
        "http.request.bytes": {"type": "long"},
        "http.response.body.bytes": {"type": "long"},
        "http.response.body.content": {"type": "keyword", "fields": {"text": {"type": "text"}}},
        "http.response.bytes": {"type": "long"},
        "http.response.status_code": {"type": "short"},
        "http.version": {"type": "keyword"},
        "interface": {"type": "object"},
        "interface.alias": {"type": "keyword"},
        "interface.id": {"type": "keyword"},
        "interface.name": {"type": "keyword"},
        "log": {"type": "object"},
        "log.level": {"type": "keyword"},
        "log.origin.file.line": {"type": "long"},
        "log.syslog": {"type": "object"},
        "log.syslog.facility.code": {"type": "long"},
        "log.syslog.priority": {"type": "long"},
        "log.syslog.severity.code": {"type": "long"},
        "network": {"type": "object"},
        "network.bytes": {"type": "integer"},
        "network.community_id": {"type": "keyword"},
        "network.forwarded_ip": {"type": "ip"},
        "network.iana_number": {"type": "short"},
        "network.inner": {"type": "object"},
        "network.packets": {"type": "long"},
        "observer": {"type": "object"},
        "observer.ip": {"type": "ip"},
        "observer.mac": {"type": "keyword"},
        "observer.serial_number": {"type": "keyword"},
        "observer.version": {"type": "keyword"},
        "orchestrator": {"type": "object"},
        "organization": {"type": "object"},
        "organization.id": {"type": "keyword"},
        "os": {"type": "object"},
        "os.family": {"type": "keyword"},
        "os.full": {"type": "keyword", "fields": {"text": {"type": "text"}}},
        "os.kernel": {"type": "keyword"},
        "os.name": {"type": "keyword", "fields": {"text": {"type": "text"}}},
        "os.platform": {"type": "keyword"},
        "os.type": {"type": "keyword"},
        "os.version": {"type": "keyword"},
        "package": {"type": "object"},
        "pe": {"type": "object"},
        "process": {"type": "object"},
        "process.args": {"type": "keyword"},
        "process.args_count": {"type": "long"},
        "process.command_line": {"type": "keyword", "fields": {"text": {"type": "text"}}},
        "process.entity_id": {"type": "keyword"},
        "process.exit_code": {"type": "long"},
        "process.pgid": {"type": "long"},
        "process.pid": {"type": "long"},
        "process.ppid": {"type": "long"},
        "process.start": {"type": "date"},
        "process.thread.id": {"type": "long"},
        "process.uptime": {"type": "long"},
        "registry": {"type": "object"},
        "related": {"type": "object"},
        "related.hash": {"type": "keyword"},
        "related.hosts": {"type": "keyword"},
        "related.ip": {"type": "ip"},
        "related.user": {"type": "keyword"},
        "rule": {"type": "object"},
        "rule.author": {"type": "keyword"},
        "rule.category": {"type": "keyword"},
        "rule.description": {"type": "keyword"},
        "rule.id": {"type": "keyword"},
        "rule.uuid": {"type": "keyword"},
        "rule.version": {"type": "keyword"},
        "server": {"type": "object"},
        "service": {"type": "object"},
        "service.ephemeral_id": {"type": "keyword"},
        "service.id": {"type": "keyword"},
        "service.version": {"type": "keyword"},
        "source": {"type": "object"},
        "source.address": {"type": "keyword"},
        "source.as.number": {"type": "integer"},
        "source.as.organization.name": {"type": "keyword"},
        "source.bytes": {"type": "long"},
        "source.geo.city_name": {"type": "keyword"},
        "source.geo.country_iso_code": {"type": "keyword"},
        "source.geo.country_name": {"type": "keyword"},
        "source.geo.location": {"type": "geo_point"},
        "source.ip": {"type": "ip"},
        "source.nat.ip": {"type": "ip"},
        "source.nat.port": {"type": "integer"},
        "source.packets": {"type": "long"},
        "source.port": {"type": "integer"},
        "threat": {"type": "object"},
        "threat.enrichments": {"type": "nested", "properties": {
          "indicator": {"type": "object"},
          "indicator.confidence": {"type": "keyword"},
          "indicator.description": {"type": "keyword"},
          "indicator.email.address": {"type": "keyword"},
          "indicator.first_seen": {"type": "date"},
          "indicator.ip": {"type": "ip"},
          "indicator.last_seen": {"type": "date"},
          "indicator.marking.tlp": {"type": "keyword"},
          "indicator.modified_at": {"type": "date"},
          "indicator.name": {"type": "keyword"},
          "indicator.port": {"type": "long"},
          "indicator.provider": {"type": "keyword"},
          "indicator.reference": {"type": "keyword"},
          "indicator.scanner_stats": {"type": "long"},
          "indicator.sightings": {"type": "long"},
          "indicator.type": {"type": "keyword"},
          "matched.atomic": {"type": "keyword"},
          "matched.field": {"type": "keyword"},
          "matched.id": {"type": "keyword"},
          "matched.index": {"type": "keyword"},
          "matched.occurred": {"type": "date"},
          "matched.type": {"type": "keyword"}}},
        "threat.matched.indicators": {"type": "keyword"},
        "threat.matched.names": {"type": "keyword"},
        "threat.matched.providers": {"type": "keyword"},
        "threat.matched.types": {"type": "keyword"},
        "tls": {"type": "object"},
        "span.id": {"type": "keyword"},
        "trace.id": {"type": "keyword"},
        "transaction.id": {"type": "keyword"},
        "url": {"type": "object"},
        "url.full": {"type": "keyword", "fields": {"text": {"type": "text"}}},
        "url.original": {"type": "keyword", "fields": {"text": {"type": "text"}}},
        "url.port": {"type": "long"},
        "user": {"type": "object"},
        "user.id": {"type": "keyword"},
        "user.name": {"type": "keyword"},
        "user.roles": {"type": "keyword"},
        "user_agent": {"type": "object"},
        "user_agent.device.name": {"type": "keyword"},
        "user_agent.name": {"type": "keyword"},
        "user_agent.original": {"type": "keyword", "fields": {"text": {"type": "text"}}},
        "user_agent.os.family": {"type": "keyword", "fields": {"text": {"type": "text"}}},
        "user_agent.os.full": {"type": "keyword"},
        "user_agent.os.kernel": {"type": "keyword"},
        "user_agent.os.name": {"type": "keyword", "fields": {"text": {"type": "text"}}},
        "user_agent.os.platform": {"type": "keyword"},
        "user_agent.os.type": {"type": "keyword"},
        "user_agent.os.version": {"type": "keyword"},
        "user_agent.version": {"type": "keyword"},
        "vlan": {"type": "object"},
        "vlan.id": {"type": "keyword"},
        "vulnerability.category": {"type": "keyword"},
        "vulnerability.classification": {"type": "keyword"},
        "vulnerability.description": {"type": "keyword", "fields": {"text": {"type": "text"}}},
        "vulnerability.enumeration": {"type": "keyword"},
        "vulnerability.id": {"type": "keyword"},
        "vulnerability.reference": {"type": "keyword"},
        "vulnerability.report_id": {"type": "keyword"},
        "vulnerability.scanner.vendor": {"type": "keyword"},
        "vulnerability.score.base": {"type": "float"},
        "vulnerability.score.environmental": {"type": "float"},
        "vulnerability.score.temporal": {"type": "float"},
        "vulnerability.score.version": {"type": "keyword"},
        "vulnerability.severity": {"type": "keyword"},
        "x509": {"type": "object"}
      }
    }
  }
}
